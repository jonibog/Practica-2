<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <title>Crear Producto</title>
    <script>
        function crearProducto() {
            const nombre = document.getElementById('nombreProducto').value;
            const productor = document.getElementById('productor').value;
            const cantidad = parseInt(document.getElementById('cantidad').value);

            if (!nombre || !productor || isNaN(cantidad)) {
                alert("Por favor, ingresa todos los datos.");
                return;
            }

            const productos = JSON.parse(localStorage.getItem('productos')) || [];
            productos.push({ nombre, productor, cantidad });
            localStorage.setItem('productos', JSON.stringify(productos));

            alert("Producto creado exitosamente.");
            mostrarProductos();
        }

        function mostrarProductos() {
            const productos = JSON.parse(localStorage.getItem('productos')) || [];
            const listaProductos = document.getElementById('listaProductos');
            listaProductos.innerHTML = '';

            productos.forEach((producto, index) => {
                const li = document.createElement('li');
                li.textContent = `Producto: ${producto.nombre}, Productor: ${producto.productor}, Cantidad: ${producto.cantidad}`;

                const botonEditar = document.createElement('button');
                botonEditar.textContent = 'Editar';
                botonEditar.onclick = () => editarProducto(index);

                const botonBorrar = document.createElement('button');
                botonBorrar.textContent = 'Borrar';
                botonBorrar.onclick = () => borrarProducto(index);

                const botonVenta = document.createElement('button');
                botonVenta.textContent = 'Venta';
                botonVenta.onclick = () => registrarVenta(index);

                li.appendChild(botonEditar);
                li.appendChild(botonBorrar);
                li.appendChild(botonVenta);

                listaProductos.appendChild(li);
            });
        }

        function borrarProducto(index) {
            const productos = JSON.parse(localStorage.getItem('productos')) || [];
            productos.splice(index, 1);
            localStorage.setItem('productos', JSON.stringify(productos));
            alert("Producto eliminado exitosamente.");
            mostrarProductos();
        }

        function editarProducto(index) {
            const productos = JSON.parse(localStorage.getItem('productos')) || [];
            const producto = productos[index];

            document.getElementById('nombreProducto').value = producto.nombre;
            document.getElementById('productor').value = producto.productor;
            document.getElementById('cantidad').value = producto.cantidad;

            productos.splice(index, 1);
            localStorage.setItem('productos', JSON.stringify(productos));
            mostrarProductos();
        }

        function registrarVenta(index) {
            const productos = JSON.parse(localStorage.getItem('productos')) || [];
            const producto = productos[index];

            const cantidadVendida = parseInt(prompt(`Cantidad a vender de ${producto.nombre}:`));
            const precioPorUnidad = parseFloat(prompt("Precio por unidad:"));

            if (isNaN(cantidadVendida) || isNaN(precioPorUnidad) || cantidadVendida <= 0 || precioPorUnidad <= 0) {
                alert("Por favor, ingresa valores vÃ¡lidos.");
                return;
            }

            if (cantidadVendida > producto.cantidad) {
                alert("No hay suficiente cantidad disponible.");
                return;
            }

            producto.cantidad -= cantidadVendida;
            localStorage.setItem('productos', JSON.stringify(productos));

            const totalVenta = cantidadVendida * precioPorUnidad;

            alert(`
                Factura de Venta
                ------------------
                Producto: ${producto.nombre}
                Cantidad Vendida: ${cantidadVendida}
                Precio por Unidad: $${precioPorUnidad.toFixed(2)}
                Total: $${totalVenta.toFixed(2)}
            `);

            mostrarProductos();
        }

        window.onload = mostrarProductos;
    </script>
</head>
<body>
    <h1>Crear Producto</h1>
    <label for="nombreProducto">Nombre del Producto:</label>
    <input type="text" id="nombreProducto">
    <br>

    <label for="productor">Productor:</label>
    <input type="text" id="productor">
    <br>

    <label for="cantidad">Cantidad:</label>
    <input type="number" id="cantidad">
    <br>

    <button onclick="crearProducto()">Crear Producto</button>

    <h2>Lista de Productos</h2>
    <ul id="listaProductos"></ul>
</body>
</html>
